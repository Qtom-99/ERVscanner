# ERVscanner
Fast tool to estimate ERV insertion based on short read data
]
ERVscanner is a tool to estimate new ERV insertions based on short read whole genome data.
It is divided into two pipelines, one for detecting insertions within MRs and the other for detecting insertions outside MRs. Pipeline 1 to Pipeline 6 are used for insertions outside of MR. Note that add_pipe1 uses the output file of Pipeline1, so Pipeline1 must be completed first.
Each insertion is grouped in your_datapath/vcf and your_datapath/inMR/vcf, and the final output is generated by using merge_vcf.py at the end.

Contents of each process
Pipeline1, add_pipe1
  process1 Extract both read pairs in which one of the paired ends is mapped to an ERV region in the reference genome (add_pipe1 uses pairs in which both are mapped to MRs)
  process2 Estimation of insertion position Extract reads that map to non-ERV regions.
  process3 Create fastq file of RERVreads Extract reads mapped to ERV
Pipeline2
  process4 Merge and map fastqs Reads attached to ERVs and map them back to the database
  process5 Create list of insert positions
Pipeline3
  process6 Match each sample's insertions with position IDs
Pipeline4
  process7 Filter by insertion sequence estimation, create cross table of 01
Pipeline5, add_pipe5
  process8 Genotyping
Pipeline6
  process9 Creation of VCF

How to use
First, create the directory where the data will be placed in advance with mkdir.sh.
Pipeline1 and add_pipe5 can be run in parallel by dividing samples.
Pipeline 2 is a merging process and should be executed after pipeline 1 has been completed for all samples.
Pipeline 3 can be run in parallel with separate samples.
Pipeline 4 is a merging and filtering process and should be executed after Pipeline 3 has been completed for all samples.
Pipeline 5 and add_pipe5 can be run in parallel with separate samples.
Pipeline 6 is a merging process and should be executed after Pipeline 5 or add_pipe5 has been completed for all samples.

Required Files
1BAM or CRAM for each sample
2Tab-separated DFAM_ERV dictionary (You can copy and paste the filtered content of the screen as https://dfam.org/browse is.)
    #Accession Name Classification Clades Description Length
    #DF000001893 LTRIS2 ERV1 Mus Mouse subfamily of LTR retrotransposons 564
3Multifaster file to identify ERVs (ALU, LINE, etc. should be included)
4Line-delimited list of all samples
5BED file of ERV regions obtained from DFAM
6A newline-separated list of alternative chromosomes in the reference genome of the organism to be analyzed

Required Tools and Environment
Python3
bedtools 2.27.1
samtools 1.20 or higher
bwa 

Notes
The threshold argument for filtering is not a percentage, but a ratio.
